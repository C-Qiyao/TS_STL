# Thread-Safe STL (TS_STL) åº“

**[English README](README.md)**

è¿™æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ã€æ˜“ç”¨çš„çº¿ç¨‹å®‰å…¨STLå®¹å™¨ä»£ç†åº“ã€‚æä¾›äº†ä¸€ä¸ªä¼˜é›…çš„æ¨¡æ¿æ¡†æ¶ï¼ˆHead-onlyï¼‰ï¼Œç”¨äºåˆ›å»ºçº¿ç¨‹å®‰å…¨çš„STLå®¹å™¨ï¼Œæ”¯æŒäº’æ–¥é”ã€è¯»å†™é”ã€è‡ªæ—‹é”ä¸‰ç§åŒæ­¥æœºåˆ¶ã€‚

## ğŸ“‹ ç‰¹æ€§æ¦‚è§ˆ

### æ ¸å¿ƒç‰¹æ€§
- âœ… **å››é”ç­–ç•¥**: äº’æ–¥é”ã€è¯»å†™é”ã€è‡ªæ—‹é”å’Œæ— é”ï¼Œå¯åœ¨åˆå§‹åŒ–æ—¶é€‰æ‹©
- âœ… **è‡ªåŠ¨åŒæ­¥**: æ‰€æœ‰å…³é”®æ“ä½œè‡ªåŠ¨çº¿ç¨‹å®‰å…¨ï¼Œæ— éœ€æ‰‹åŠ¨åŠ é”
- âœ… **STLå…¼å®¹**: æ”¯æŒéšå¼è½¬æ¢åˆ°æ ‡å‡†å®¹å™¨ï¼Œä¸STLç®—æ³•åº“å…¼å®¹
- âœ… **é›¶å¼€é”€æŠ½è±¡**: ç¼–è¯‘æ—¶å¤šæ€ï¼ˆCRTPï¼‰ï¼Œä¸ä½¿ç”¨çš„ä»£ç è·¯å¾„è¢«å®Œå…¨ä¼˜åŒ–æ‰
- âœ… **å¼‚å¸¸å®‰å…¨**: RAIIæ¨¡å¼ç¡®ä¿å¼‚å¸¸æƒ…å†µä¸‹çš„å®‰å…¨æ€§
- âœ… **ä¸°å¯ŒAPI**: operator[]ã€get/setæ¥å£ã€è¿­ä»£ã€æŸ¥æ‰¾ã€å®¹é‡ç®¡ç†ç­‰
- âœ… **é«˜æ€§èƒ½**: æœ€å°åŒ–é”ç²’åº¦ï¼Œæ”¯æŒç§»åŠ¨è¯­ä¹‰
- âœ… **æ˜“äºæ‰©å±•**: ä½¿ç”¨ CRTP å‡å°‘ä»£ç é‡å¤ï¼Œæ·»åŠ æ–°å®¹å™¨åªéœ€æœ€å°‘ä»£ç 

### å®ç°ç‰¹æ€§
- ğŸ”’ äº’æ–¥é”ï¼ˆMutexï¼‰: ç®€æ´é«˜æ•ˆï¼Œé€‚åˆé€šç”¨åœºæ™¯
- ğŸ” è¯»å†™é”ï¼ˆReadWriteï¼‰: å…è®¸å¹¶å‘è¯»ï¼Œé€‚åˆè¯»å¯†é›†å‹åº”ç”¨
- ğŸ”„ è‡ªæ—‹é”ï¼ˆSpinLockï¼‰: æä½å»¶è¿Ÿï¼Œé€‚åˆçŸ­ä¸´ç•ŒåŒº
- âš¡ æ— é”ï¼ˆLockFreeï¼‰: é›¶å¼€é”€ï¼Œæé™æ€§èƒ½ï¼Œéœ€è¦å¤–éƒ¨åŒæ­¥
- ğŸ“¦ RAIIæ¨¡å¼: è‡ªåŠ¨é”ç®¡ç†
- ğŸ¯ ç¼–è¯‘æ—¶æ¡ä»¶: é›¶æˆæœ¬çš„ç­–ç•¥é€‰æ‹©
- ğŸ›¡ï¸ å¼‚å¸¸å¤„ç†: å®Œæ•´çš„å¼‚å¸¸å®‰å…¨ä¿è¯
- ğŸ—ï¸ CRTPè®¾è®¡: é™æ€å¤šæ€ï¼Œæ¶ˆé™¤ä»£ç é‡å¤

### ğŸ”´ å¤šçº¿ç¨‹å®‰å…¨æ€§å¯¹æ¯”

| æµ‹è¯• | TS_STL | STD å®¹å™¨ |
|------|--------|----------|
| å•çº¿ç¨‹å†™å…¥ | âœ… 100% æ­£ç¡® | âœ… 100% æ­£ç¡® |
| **å¹¶å‘å†™å…¥** | âœ… **100% æ­£ç¡®** | âŒ **CRASH** |
| **å¹¶å‘è¯»å–** | âœ… **100% æ­£ç¡®** | âŒ **çº¿ç¨‹ä¸å®‰å…¨** |
| **æ··åˆè¯»å†™** | âœ… **100% æ­£ç¡®** | âŒ **CRASH** |

> âš ï¸ **é‡è¦**: STD å®¹å™¨åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼

### å¹¶å‘è¯»å†™æ€§èƒ½å»ºè®®é€ŸæŸ¥

```
âœ… é€‰æ‹© vectorMutex       â†’ é€šç”¨æœ€ä½³ï¼Œæ‰€æœ‰åœºæ™¯ç¨³å®šé«˜æ•ˆ
âœ… é€‰æ‹© vectorLockFree    â†’ å•çº¿ç¨‹åˆå§‹åŒ–ï¼Œé›¶å¼€é”€(100%æ€§èƒ½)
âš ï¸ è°¨æ… vectorRW          â†’ è¯»å†™é”ä¼˜åŠ¿æœªæ˜æ˜¾ä½“ç°
âš ï¸ é¿å… vectorSpinLock    â†’ é«˜å¹¶å‘ç«äº‰åœºæ™¯æ€§èƒ½å·®(ä»…20%)
âŒ å¤šçº¿ç¨‹ä¸è¦ç”¨ std::vector â†’ çº¿ç¨‹ä¸å®‰å…¨ä¼šå´©æºƒ
```

**æ€§èƒ½æ•°æ®**: 
- `vectorLockFree` å•çº¿ç¨‹æ€§èƒ½ = std::vector çš„ 100%ï¼ˆé›¶å¼€é”€ï¼‰
- `vectorMutex` å¤šçº¿ç¨‹æ€§èƒ½ = std::vector+mutex çš„ 79-87%ï¼ˆå®‰å…¨+æ˜“ç”¨ï¼‰


### ğŸ¯ æ•°æ®å‡†ç¡®æ€§éªŒè¯

| é”ç±»å‹ | å•çº¿ç¨‹ | å¹¶å‘å†™ | å¹¶å‘è¯» | 90%è¯»10%å†™ | 50%è¯»50%å†™ | å¤§å¯¹è±¡ | æ€»ä½“ |
|--------|--------|--------|--------|-----------|-----------|--------|------|
| **Mutex** | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… 6/6 |
| **SpinLock** | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… 6/6 |
| **RW-Lock** | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… 6/6 |
| **STD Vector** | âœ… | âŒ CRASH | âŒ UNSAFE | âŒ CRASH | âŒ CRASH | - | âŒ 0/6 |

**ç»“è®º**: 
- âœ… **TS_STL åœ¨æ‰€æœ‰ 6 ä¸ªåœºæ™¯éƒ½ 100% æ­£ç¡® (18/18 æµ‹è¯•é€šè¿‡)**
- âŒ **STD å®¹å™¨åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å®Œå…¨ä¸å®‰å…¨**

## æ€§èƒ½æµ‹è¯•ç»“æœ

### Concurrent Read

| å®¹å™¨ç±»å‹ | è€—æ—¶(ms) | æ“ä½œæ•° | ååé‡(ops/ms) | ç›¸å¯¹æ€§èƒ½ | æ•°æ®æ­£ç¡® |
|---------|---------|--------|---------------|---------|----------|
| std::vector+mutex | 20.45 | 1200000 | 58672 | 100.0% | âœ“ |
| vectorMutex | 23.46 | 1200000 | 51152 | 87.2% | âœ“ |
| vectorSpinLock | 284.53 | 1200000 | 4218 | 7.2% | âœ“ |
| vectorRW | 113.14 | 1200000 | 10606 | 18.1% | âœ“ |

### Concurrent Write

| å®¹å™¨ç±»å‹ | è€—æ—¶(ms) | æ“ä½œæ•° | ååé‡(ops/ms) | ç›¸å¯¹æ€§èƒ½ | æ•°æ®æ­£ç¡® |
|---------|---------|--------|---------------|---------|----------|
| std::vector+mutex | 16.80 | 800000 | 47611 | 100.0% | âœ“ |
| vectorMutex | 20.44 | 800000 | 39143 | 82.2% | âœ“ |
| vectorSpinLock | 234.15 | 800000 | 3417 | 7.2% | âœ“ |
| vectorRW | 87.90 | 800000 | 9101 | 19.1% | âœ“ |

### Mixed R/W (50:50)

| å®¹å™¨ç±»å‹ | è€—æ—¶(ms) | æ“ä½œæ•° | ååé‡(ops/ms) | ç›¸å¯¹æ€§èƒ½ | æ•°æ®æ­£ç¡® |
|---------|---------|--------|---------------|---------|----------|
| std::vector+mutex | 12.69 | 800000 | 63037 | 100.0% | âœ“ |
| vectorMutex | 15.98 | 800000 | 50075 | 79.4% | âœ“ |
| vectorSpinLock | 149.89 | 800000 | 5337 | 8.5% | âœ“ |
| vectorRW | 97.37 | 800000 | 8216 | 13.0% | âœ“ |

### Mixed R/W (90:10)

| å®¹å™¨ç±»å‹ | è€—æ—¶(ms) | æ“ä½œæ•° | ååé‡(ops/ms) | ç›¸å¯¹æ€§èƒ½ | æ•°æ®æ­£ç¡® |
|---------|---------|--------|---------------|---------|----------|
| std::vector+mutex | 15.92 | 1000000 | 62812 | 100.0% | âœ“ |
| vectorMutex | 19.83 | 1000000 | 50441 | 80.3% | âœ“ |
| vectorSpinLock | 185.57 | 1000000 | 5389 | 8.6% | âœ“ |
| vectorRW | 112.56 | 1000000 | 8884 | 14.1% | âœ“ |

### Single Thread Push Back

| å®¹å™¨ç±»å‹ | è€—æ—¶(ms) | æ“ä½œæ•° | ååé‡(ops/ms) | ç›¸å¯¹æ€§èƒ½ | æ•°æ®æ­£ç¡® |
|---------|---------|--------|---------------|---------|----------|
| std::vector | 2.22 | 1000000 | 449800 | 100.0% | âœ“ |
| vectorMutex | 6.68 | 1000000 | 149720 | 33.3% | âœ“ |
| vectorSpinLock | 3.98 | 1000000 | 251317 | 55.9% | âœ“ |
| vectorLockFree | 2.24 | 1000000 | 446778 | 99.3% | âœ“ |
| vectorRW | 13.36 | 1000000 | 74824 | 16.6% | âœ“ |

### Map Concurrent Insert

| å®¹å™¨ç±»å‹ | è€—æ—¶(ms) | æ“ä½œæ•° | ååé‡(ops/ms) | ç›¸å¯¹æ€§èƒ½ | æ•°æ®æ­£ç¡® |
|---------|---------|--------|---------------|---------|----------|
| mapMutex | 1852.94 | 80000 | 43 | 100.0% | âœ“ |
| mapRW | 2507.65 | 80000 | 32 | 73.9% | âœ“ |

### Map Concurrent Read

| å®¹å™¨ç±»å‹ | è€—æ—¶(ms) | æ“ä½œæ•° | ååé‡(ops/ms) | ç›¸å¯¹æ€§èƒ½ | æ•°æ®æ­£ç¡® |
|---------|---------|--------|---------------|---------|----------|
| mapMutex | 60.15 | 1200000 | 19951 | 100.0% | âœ“ |
| mapRW | 98.54 | 1200000 | 12178 | 61.0% | âœ“ |

### Map Single Thread Insert

| å®¹å™¨ç±»å‹ | è€—æ—¶(ms) | æ“ä½œæ•° | ååé‡(ops/ms) | ç›¸å¯¹æ€§èƒ½ | æ•°æ®æ­£ç¡® |
|---------|---------|--------|---------------|---------|----------|
| mapMutex | 124.77 | 10000 | 80 | 97.3% | âœ“ |
| mapRW | 121.34 | 10000 | 82 | 100.0% | âœ“ |

### æ€§èƒ½ä½¿ç”¨å»ºè®®

```
åœºæ™¯                     æ¨èå®¹å™¨
----------------------  ---------------------------
å•çº¿ç¨‹/åˆå§‹åŒ–           vectorLockFree (é›¶å¼€é”€)
å¤šçº¿ç¨‹å¹¶å‘å†™å…¥           vectorMutex or vectorSpinLock
å¤šçº¿ç¨‹å¹¶å‘è¯»å–           vectorRW (è¯»å†™é”ä¼˜åŠ¿æ˜æ˜¾)
è¯»å¤šå†™å°‘(90:10)         vectorRW (è¯»å†™é”æœ€ä¼˜)
è¯»å†™å‡è¡¡(50:50)         vectorMutex (é€šç”¨ç¨³å®š)
é«˜ç«äº‰åœºæ™¯              é¿å… vectorSpinLock
```

---

### ä½¿ç”¨å»ºè®®

```cpp
// âœ… æ­£ç¡®ï¼šåˆå§‹åŒ–é˜¶æ®µ
vectorLockFree<int> init_data;
for (int i = 0; i < 1000000; ++i) {
    init_data.push_back(i);  // æå¿«ï¼
}

// åˆ‡æ¢åˆ°çº¿ç¨‹å®‰å…¨ç‰ˆæœ¬
vectorMutex<int> safe_data(init_data);

// âŒ é”™è¯¯ï¼šå¹¶å‘è®¿é—®
std::thread t1([&init_data]() { init_data.push_back(1); });
std::thread t2([&init_data]() { init_data.push_back(2); });
// ä¼šå¯¼è‡´å´©æºƒï¼
```


## ğŸ“¦ æ”¯æŒçš„å®¹å™¨

TS_STL ç°å·²æ”¯æŒä»¥ä¸‹çº¿ç¨‹å®‰å…¨å®¹å™¨ï¼š

### å·²å®ç°çš„å®¹å™¨

| å®¹å™¨ | è¯´æ˜ | ç”¨é€” |
|------|------|------|
| **vector** | åºåˆ—å®¹å™¨ï¼Œå¿«é€Ÿéšæœºè®¿é—® | å¤§å¤šæ•°æ•°æ®å­˜å‚¨åœºæ™¯ |
| **list** | é“¾è¡¨å®¹å™¨ï¼Œå¿«é€Ÿæ’å…¥åˆ é™¤ | é¢‘ç¹æ’å…¥åˆ é™¤æ“ä½œ |
| **map** | æœ‰åºå…³è”å®¹å™¨ï¼Œé”®å€¼å¯¹å­˜å‚¨ | å­—å…¸ã€ç¼“å­˜ã€é…ç½®å­˜å‚¨ |

#### å®¹å™¨åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | Vector | List | Map |
|------|--------|------|-----|
| éšæœºè®¿é—® | âœ… O(1) | âŒ O(n) | âŒ O(log n) |
| é¡ºåºéå† | âœ… | âœ… | âœ… |
| å¤´éƒ¨æ’å…¥ | âŒ O(n) | âœ… O(1) | âœ… O(log n) |
| å°¾éƒ¨æ’å…¥ | âœ… O(1)* | âœ… O(1) | âœ… O(log n) |
| é”®å€¼æŸ¥è¯¢ | âŒ | âŒ | âœ… O(log n) |
| çº¿ç¨‹å®‰å…¨ | âœ… | âœ… | âœ… |
| å¤šé”ç­–ç•¥ | âœ… (4ç§) | âœ… (4ç§) | âœ… (4ç§) |

### Vector ç‰¹æ€§

```cpp
#include "ts_stl.hpp"

// åˆ›å»ºçº¿ç¨‹å®‰å…¨çš„å‘é‡ï¼ˆé»˜è®¤ä½¿ç”¨äº’æ–¥é”ï¼‰
ts_stl::vectorMutex<int> vec;

// ä½¿ç”¨å°±åƒæ ‡å‡†vectorä¸€æ ·
vec.push_back(1);
vec.push_back(2);
vec[0] = 10;              // çº¿ç¨‹å®‰å…¨çš„æ•°ç»„é£æ ¼è®¿é—®
std::cout << vec.size();  // çº¿ç¨‹å®‰å…¨çš„æŸ¥è¯¢
```

### List ç‰¹æ€§

```cpp
#include "ts_stl.hpp"

// åˆ›å»ºçº¿ç¨‹å®‰å…¨çš„é“¾è¡¨
ts_stl::listMutex<int> list;

// æ”¯æŒlistç‰¹æœ‰æ“ä½œ
list.push_back(1);
list.push_front(0);
list.sort();              // æ’åº
list.reverse();           // åè½¬
list.remove(1);           // åˆ é™¤æŒ‡å®šå€¼
```

### Map ç‰¹æ€§

```cpp
#include "ts_stl.hpp"

// åˆ›å»ºçº¿ç¨‹å®‰å…¨çš„å­—å…¸
ts_stl::mapMutex<std::string, int> scores;

// æ’å…¥å’ŒæŸ¥è¯¢
scores.insert("Alice", 90);
scores.set("Bob", 85);

// è·å–å€¼ï¼ˆæ”¯æŒé»˜è®¤å€¼ï¼‰
int score = scores.get("Alice");
int missing = scores.get("Charlie", -1);  // ä¸å­˜åœ¨è¿”å›-1

// æ£€æŸ¥å­˜åœ¨æ€§
if (scores.contains("Alice")) {
    std::cout << "Alice found!" << std::endl;
}

// éå†
scores.for_each([](const auto& key, const auto& value) {
    std::cout << key << ": " << value << std::endl;
});

// åˆ é™¤
scores.erase("Bob");

// æ¡ä»¶ç»Ÿè®¡
int high_scores = scores.count_if([](const auto& key, const auto& value) {
    return value >= 80;
});
```

### operator[] vs get/set - é€‰æ‹©æŒ‡å—

| æ–¹æ³• | ç”¨é€” | è¾¹ç•Œæ£€æŸ¥ | æ¨èåœºæ™¯ |
|------|------|---------|---------|
| `vec[i]` | å¿«é€Ÿè¯»å†™ | âŒ æ—  | å·²éªŒè¯ç´¢å¼•çš„ç´§å¯†å¾ªç¯ |
| `vec.get(i)` | ä»…è¯»å– | âŒ æ—  | å¹¶å‘å¤šè¯»åœºæ™¯ |
| `vec.set(i, val)` | ä»…å†™å…¥ | âŒ æ—  | åŸè¯­æ„æ¸…æ™°çš„æ›´æ–° |
| `vec.at(i)` | å®‰å…¨è¯»å†™ | âœ… æœ‰ | ä¸ä¿¡ä»»ç´¢å¼•æ¥æºçš„ä»£ç  |

```cpp
// æ€§èƒ½æ•æ„Ÿçš„ç´§å¯†å¾ªç¯ - ç”¨ operator[]
for (size_t i = 0; i < vec.size(); ++i) {
    total += vec[i];  // å¿«é€Ÿï¼Œæ— æ£€æŸ¥å¼€é”€
}

// éœ€è¦å®‰å…¨æ€§ - ç”¨ at()
try {
    std::cout << vec.at(100);  // è‡ªåŠ¨æ£€æŸ¥è¶Šç•Œ
} catch (const std::out_of_range& e) {
    std::cerr << "Error: " << e.what() << std::endl;
}
```

### å¯¹è±¡åˆå§‹åŒ– - é€‰æ‹©é”ç­–ç•¥

#### æ–¹å¼1ï¸âƒ£: ä½¿ç”¨ä¾¿åˆ©ç±»å‹åˆ«åï¼ˆæ¨èï¼‰

```cpp
// äº’æ–¥é”ç‰ˆæœ¬ - é€šç”¨ã€é«˜æ•ˆ
vectorMutex<int> mutex_vec;
mutex_vec.push_back(1);
mutex_vec.push_back(2);

// è¯»å†™é”ç‰ˆæœ¬ - é€‚åˆè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼ˆC++17+ï¼‰
vectorRW<std::string> rw_vec;
rw_vec.push_back("hello");
rw_vec.push_back("world");

// æ— é”ç‰ˆæœ¬ - æé™æ€§èƒ½ï¼Œå•çº¿ç¨‹åˆå§‹åŒ–é˜¶æ®µ âš¡
vectorLockFree<int> lockfree_vec;
for (int i = 0; i < 1000000; ++i) {
    lockfree_vec.push_back(i);  // é›¶é”å¼€é”€ï¼
}
```

#### æ–¹å¼2ï¸âƒ£: æ˜¾å¼æŒ‡å®šé”ç­–ç•¥æ¨¡æ¿å‚æ•°

```cpp
// äº’æ–¥é”ï¼ˆæ˜ç¡®æŒ‡å®šï¼‰
vector<int, LockPolicy::Mutex> explicit_mutex;
explicit_mutex.push_back(100);

// æ— é”ç­–ç•¥ï¼ˆæ˜ç¡®æŒ‡å®š - éœ€è¦å¤–éƒ¨åŒæ­¥ï¼‰
vector<int, LockPolicy::LockFree> explicit_lockfree;
explicit_lockfree.push_back(100);

// è¯»å†™é”ï¼ˆæ˜ç¡®æŒ‡å®šï¼Œä»…C++17+ï¼‰
#if TS_STL_SUPPORT_RW_LOCK
vector<int, LockPolicy::ReadWrite> explicit_rw;
explicit_rw.push_back(200);
#endif
```

#### æ–¹å¼3ï¸âƒ£: é»˜è®¤åˆå§‹åŒ–

```cpp
// é»˜è®¤ä½¿ç”¨äº’æ–¥é”
vector<double> default_vec;
default_vec.push_back(3.14);
```

#### æ–¹å¼4ï¸âƒ£: æ„é€ æ—¶ä¼ å…¥åˆå§‹æ•°æ®

```cpp
// åˆ›å»ºåŒ…å«åˆå§‹å…ƒç´ çš„å‘é‡
vectorMutex<int> initialized_vec(5);  // 5ä¸ªé»˜è®¤å…ƒç´ 
vectorMutex<int> filled_vec(5, 42);   // 5ä¸ªå€¼ä¸º42çš„å…ƒç´ 

// ä½¿ç”¨è¿­ä»£å™¨èŒƒå›´åˆå§‹åŒ–
std::vector<int> init_data = {1, 2, 3, 4, 5};
vectorMutex<int> from_range(init_data.begin(), init_data.end());
```

### Vector å¤šçº¿ç¨‹æ“ä½œ

```cpp
vectorMutex<int> shared_vec;

// å¤šä¸ªçº¿ç¨‹å¯ä»¥å®‰å…¨åœ°åŒæ—¶è®¿é—®
std::vector<std::thread> threads;
for (int i = 0; i < 4; ++i) {
    threads.emplace_back([&shared_vec, i]() {
        for (int j = 0; j < 100; ++j) {
            shared_vec.push_back(i * 100 + j);  // è‡ªåŠ¨çº¿ç¨‹å®‰å…¨ï¼
        }
    });
}

for (auto& t : threads) {
    t.join();
}
// ç°åœ¨æœ‰ 400 ä¸ªå…ƒç´ ï¼Œå®Œå…¨æ²¡æœ‰ç«æ€æ¡ä»¶
```

### List å¤šçº¿ç¨‹æ“ä½œ

```cpp
listMutex<int> shared_list;

// å¤šçº¿ç¨‹å®‰å…¨åœ°æ·»åŠ å…ƒç´ 
std::vector<std::thread> threads;
for (int i = 0; i < 4; ++i) {
    threads.emplace_back([&shared_list, i]() {
        for (int j = 0; j < 50; ++j) {
            // æ—¢å¯ä»¥ä»æœ«å°¾æ·»åŠ 
            if (i % 2 == 0) {
                shared_list.push_back(i * 50 + j);
            } else {
                // ä¹Ÿå¯ä»¥ä»é¦–éƒ¨æ·»åŠ 
                shared_list.push_front(i * 50 + j);
            }
        }
    });
}

for (auto& t : threads) {
    t.join();
}

// æ’åºå’Œå¤„ç†
shared_list.sort();
shared_list.remove_if([](int x) { return x % 10 == 0; });
```

### Map å¤šçº¿ç¨‹æ“ä½œ

```cpp
mapMutex<std::string, int> cache;

// å¤šçº¿ç¨‹å®‰å…¨åœ°æ›´æ–°ç¼“å­˜
std::vector<std::thread> threads;
for (int i = 0; i < 4; ++i) {
    threads.emplace_back([&cache, i]() {
        for (int j = 0; j < 100; ++j) {
            std::string key = "key_" + std::to_string(i * 100 + j);
            cache.insert(key, i * 100 + j);
        }
    });
}

for (auto& t : threads) {
    t.join();
}

// å¤šçº¿ç¨‹è¯»å–ï¼ˆä½¿ç”¨è¯»å†™é”å¯ä»¥åŠ é€Ÿï¼‰
mapRW<std::string, int> read_cache;
// ... åˆå§‹åŒ–æ•°æ® ...

std::vector<std::thread> readers;
for (int i = 0; i < 8; ++i) {  // 8ä¸ªè¯»çº¿ç¨‹
    readers.emplace_back([&read_cache]() {
        for (int j = 0; j < 1000; ++j) {
            std::string key = "key_" + std::to_string(j);
            int value = read_cache.get(key, -1);  // çº¿ç¨‹å®‰å…¨çš„è¯»å–
        }
    });
}

for (auto& t : readers) {
    t.join();
}

// éå†ç¼“å­˜ä¸­çš„æ‰€æœ‰é¡¹
cache.for_each([](const auto& key, const auto& value) {
    std::cout << key << " -> " << value << std::endl;
});
```

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ | ç”¨æ³• |
|------|---------|------|
| é€šç”¨ã€è¯»å†™å‡è¡¡ | **äº’æ–¥é”** | `vectorMutex<T>` |
| è¯»æ“ä½œè¿œå¤šäºå†™ | **è¯»å†™é”** (C++17+) | `vectorRW<T>` |
| ä¸ç¡®å®šé€‰æ‹© | **äº’æ–¥é”** | `vector<T>` |
| éœ€è¦æœ€å¤§å…¼å®¹æ€§ | **äº’æ–¥é”** | C++11/14 ä¸‹è‡ªåŠ¨é€‰æ‹© |

## ğŸ“š ä¸»è¦API

### æ”¯æŒçš„å®¹å™¨

| å®¹å™¨ | ç±»å | ç±»å‹åˆ«å | ç‰¹ç‚¹ |
|------|------|---------|------|
| `std::vector` | `vector<T, Policy>` | `vectorMutex<T>` / `vectorRW<T>` | éšæœºè®¿é—®ï¼ŒåŠ¨æ€æ•°ç»„ |
| `std::list` | `list<T, Policy>` | `listMutex<T>` / `listRW<T>` | åŒå‘é“¾è¡¨ï¼Œé«˜æ•ˆæ’åˆ  |
| `std::map` | `map<K, V, Comp, Policy>` | `mapMutex<K,V>` / `mapRW<K,V>` | æœ‰åºé”®å€¼å¯¹ï¼Œå¿«é€ŸæŸ¥æ‰¾ |

### Vector å…ƒç´ è®¿é—®
```cpp
vec[index]                  // âœ¨ æ–°å¢ï¼šæ•°ç»„é£æ ¼è®¿é—®ï¼ˆçº¿ç¨‹å®‰å…¨ï¼Œæ— è¾¹ç•Œæ£€æŸ¥ï¼‰
vec.get(index)              // è·å–å…ƒç´ ï¼ˆçº¿ç¨‹å®‰å…¨ï¼Œç­‰ä»·äº operator[]ï¼‰
vec.set(index, value)       // è®¾ç½®å…ƒç´ ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰
vec.at(index)               // å®‰å…¨è®¿é—®ï¼ˆå¸¦è¾¹ç•Œæ£€æŸ¥ï¼‰
vec.front()                 // è·å–é¦–å…ƒç´ 
vec.back()                  // è·å–æœ«å°¾å…ƒç´ 
```

### List å…ƒç´ è®¿é—®
```cpp
list.front()                // è·å–é¦–å…ƒç´ 
list.back()                 // è·å–æœ«å°¾å…ƒç´ 
list.set_front(value)       // è®¾ç½®é¦–å…ƒç´ 
list.set_back(value)        // è®¾ç½®æœ«å°¾å…ƒç´ 
```

### Map å…ƒç´ è®¿é—®
```cpp
map[key]                    // è·å–/æ’å…¥å…ƒç´ ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰
map.get(key)                // è·å–å…ƒç´ ï¼ˆä¸å­˜åœ¨è¿”å›é»˜è®¤å€¼ï¼‰
map.get(key, default_val)   // è·å–å…ƒç´ ï¼ŒæŒ‡å®šé»˜è®¤å€¼
map.set(key, value)         // è®¾ç½®å…ƒç´ 
map.at(key)                 // å®‰å…¨è®¿é—®ï¼ˆå¸¦è¾¹ç•Œæ£€æŸ¥ï¼‰
map.contains(key)           // æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨
map.count(key)              // è®¡æ•°ï¼ˆ0 æˆ– 1ï¼‰
map.count_if(predicate)     // æ¡ä»¶è®¡æ•°
map.insert(key, value)      // æ’å…¥å…ƒç´ 
map.erase(key)              // åˆ é™¤å…ƒç´ 
map.find_if(predicate)      // æ¡ä»¶æŸ¥æ‰¾
```

### é€šç”¨å®¹é‡ç®¡ç†ï¼ˆVector & List & Mapï¼‰
```cpp
vec.size()                  // è·å–å¤§å°
vec.capacity()              // è·å–å®¹é‡ï¼ˆVectorï¼‰
vec.empty()                 // æ£€æŸ¥æ˜¯å¦ä¸ºç©º
vec.reserve(count)          // é¢„ç•™ç©ºé—´ï¼ˆVectorï¼‰
vec.resize(count)           // æ”¹å˜å¤§å°
vec.shrink_to_fit()         // æ”¶ç¼©åˆ°å®é™…å¤§å°ï¼ˆVectorï¼‰
map.clear()                 // æ¸…ç©ºå®¹å™¨
```

### Vector ç‰¹å®šæ“ä½œ
```cpp
vec.push_back(value)        // æ·»åŠ å…ƒç´ 
vec.pop_back()              // ç§»é™¤æœ«å°¾å…ƒç´ 
vec.emplace_back(args...)   // åŸåœ°æ„é€ 
vec.insert(pos, value)      // æ’å…¥
vec.erase(pos)              // åˆ é™¤
```

### List ç‰¹å®šæ“ä½œ
```cpp
list.push_back(value)       // æ·»åŠ åˆ°æœ«å°¾
list.pop_back()             // ç§»é™¤æœ«å°¾å…ƒç´ 
list.push_front(value)      // æ·»åŠ åˆ°é¦–éƒ¨
list.pop_front()            // ç§»é™¤é¦–éƒ¨å…ƒç´ 
list.emplace_back(args...)  // åŸåœ°æ„é€ 
list.emplace_front(args...) // é¦–éƒ¨åŸåœ°æ„é€ 
list.remove(value)          // ç§»é™¤æ‰€æœ‰å€¼ä¸ºvalueçš„å…ƒç´ 
list.remove_if(predicate)   // ç§»é™¤æ»¡è¶³æ¡ä»¶çš„å…ƒç´ 
list.reverse()              // åè½¬åˆ—è¡¨
list.sort()                 // æ’åºåˆ—è¡¨
```

### Map ç‰¹å®šæ“ä½œ
```cpp
map.insert(key, value)      // æ’å…¥å…ƒç´ ï¼ˆè¿”å› pair<bool, size_t>ï¼‰
map.emplace(key, ...)       // åŸåœ°æ„é€ 
map.erase(key)              // åˆ é™¤å…ƒç´ 
map.for_each(func)          // éå†ï¼ˆfunc(key, value)ï¼‰
map.count_if(predicate)     // æ¡ä»¶è®¡æ•°
map.find_if(predicate)      // æ¡ä»¶æŸ¥æ‰¾
```
```cpp
// éšå¼è½¬æ¢åˆ° const std::vector<T>&
const std::vector<int>& std_ref = ts_vec;

// è·å–å‰¯æœ¬
std::vector<int> copy = ts_vec.to_vector();

// æ”¯æŒæ ‡å‡†ç®—æ³•
std::for_each(std_ref.begin(), std_ref.end(), 
    [](int x) { std::cout << x << " "; });
```

### è¿­ä»£å’ŒæŸ¥è¯¢
```cpp
vec.for_each([](const T& item) { /* process */ });
vec.find_if([](const T& item) { return item > 10; });
vec.contains(value)         // æ£€æŸ¥æ˜¯å¦åŒ…å«
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
TS_STL/
â”œâ”€â”€ include/
â”‚   â””â”€â”€ ts_stl.hpp           # æ ¸å¿ƒåº“å¤´æ–‡ä»¶
â”œâ”€â”€ test/
â”‚   â””â”€â”€ test_thread_safe_vector.cpp  # å®Œæ•´æµ‹è¯•å¥—ä»¶
â”œâ”€â”€ examples/
â”‚   â””â”€â”€ example_usage.cpp    # ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ CMakeLists.txt          # CMakeæ„å»ºé…ç½®
â”œâ”€â”€ USAGE_GUIDE.md          # è¯¦ç»†ä½¿ç”¨æŒ‡å—
â””â”€â”€ README.md              # æœ¬æ–‡ä»¶
```

## ğŸ“¦ ç¼–è¯‘å’Œè¿è¡Œ

### ä½¿ç”¨CMakeï¼ˆæ¨èï¼‰

```bash
# åˆ›å»ºæ„å»ºç›®å½•
mkdir build
cd build

# é…ç½®å’Œç¼–è¯‘
cmake ..
cmake --build .

# è¿è¡Œå•å…ƒæµ‹è¯•
./test_thread_safe_vector

# è¿è¡Œç¤ºä¾‹
./example_usage

# ğŸ¯ è¿è¡Œç»¼åˆæ€§èƒ½æµ‹è¯•ï¼ˆåŒ…å«std::vectorå¯¹æ¯”ï¼‰
./comprehensive_performance_test
```

### æ‰‹åŠ¨ç¼–è¯‘

```bash
# ç¼–è¯‘æµ‹è¯•ï¼ˆéœ€è¦C++17åŠä»¥ä¸Šï¼‰
clang++ -std=c++17 -pthread -I./include \
    test/test_thread_safe_vector.cpp -o test

# è¿è¡Œ
./test

# ç¼–è¯‘ç»¼åˆæ€§èƒ½æµ‹è¯•
clang++ -std=c++17 -O3 -pthread -I./include \
    examples/comprehensive_performance_test.cpp -o comprehensive_perf

# è¿è¡Œæ€§èƒ½æµ‹è¯•
./comprehensive_perf
```

## âœ… æµ‹è¯•è¦†ç›–

åº“åŒ…å«å…¨é¢çš„æµ‹è¯•å¥—ä»¶ï¼ˆ3ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œ35+ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰ï¼š

### ThreadSafeVector æµ‹è¯•ï¼ˆ10ä¸ªæµ‹è¯•ç»„ï¼‰
- âœ“ åŸºæœ¬æ“ä½œ (push_back, get, set, etc.)
- âœ“ å®¹é‡ç®¡ç† (resize, reserve, clear)
- âœ“ æ‹·è´å’Œç§»åŠ¨è¯­ä¹‰
- âœ“ å¤šçº¿ç¨‹å¹¶å‘è®¿é—®
- âœ“ è¯»å†™é”ç­–ç•¥éªŒè¯
- âœ“ emplace_back åŸåœ°æ„é€ 
- âœ“ éšå¼è½¬æ¢åˆ°std::vector
- âœ“ è¿­ä»£å’ŒæŸ¥æ‰¾æ“ä½œ
- âœ“ å¼‚å¸¸å¤„ç†å®‰å…¨æ€§
- âœ“ ä¸¤ç§é”ç­–ç•¥å¯¹æ¯”

### ThreadSafeList æµ‹è¯•ï¼ˆ10ä¸ªæµ‹è¯•ç»„ï¼‰
- âœ“ åŸºæœ¬æ“ä½œ (push_back, front, back)
- âœ“ é¦–éƒ¨æ“ä½œ (push_front, pop_front, emplace_front)
- âœ“ ç§»é™¤æ“ä½œ (remove, remove_if, clear)
- âœ“ æ’åºå’Œåè½¬
- âœ“ æŸ¥è¯¢æ“ä½œ (contains, count, for_each)
- âœ“ æ‹·è´å’Œç§»åŠ¨è¯­ä¹‰
- âœ“ å¤šçº¿ç¨‹å¹¶å‘è®¿é—®
- âœ“ æ‰‹åŠ¨é”æ§åˆ¶
- âœ“ å¤æ‚æ•°æ®ç±»å‹
- âœ“ åˆ—è¡¨ç‰¹å®šæ“ä½œ

### é«˜çº§åŠŸèƒ½æµ‹è¯•ï¼ˆ5ä¸ªæµ‹è¯•ç»„ï¼‰
- âœ“ çº¿ç¨‹ä¸å®‰å…¨æ¥å£æ€§èƒ½
- âœ“ æ‰‹åŠ¨é”æ§åˆ¶
- âœ“ è¯»é”æ¥å£ï¼ˆC++17+ï¼‰
- âœ“ å¤æ‚åœºæ™¯
- âœ“ æ€§èƒ½å¯¹æ¯”

## ï¿½ï¿½ é”ç­–ç•¥é€‰æ‹©æŒ‡å—

### ä½¿ç”¨äº’æ–¥é”ï¼ˆMutexï¼‰ï¼š
- âœ… è¯»å†™æ“ä½œå‡è¡¡
- âœ… å¯¹ä½å»¶è¿Ÿæ•æ„Ÿ
- âœ… ç®€å•çš„çº¿ç¨‹åè°ƒ
- âœ… ç¼“å­˜æ€§èƒ½é‡è¦

### ä½¿ç”¨è¯»å†™é”ï¼ˆReadWriteï¼‰ï¼š
- âœ… ç¼“å­˜ç³»ç»Ÿï¼ˆå¤§é‡è¯»ï¼Œå°‘é‡å†™ï¼‰
- âœ… é…ç½®ç®¡ç†ï¼ˆè¯»è¿œå¤šäºå†™ï¼‰
- âœ… ç»Ÿè®¡æ”¶é›†
- âœ… åªè¯»æ•°æ®åº“è®¿é—®

## ğŸ¯ è®¾è®¡åŸåˆ™

1. **æœ€å°åŒ–é”ç²’åº¦**: ä»…åœ¨å¿…è¦æ—¶åŠ é”
2. **é›¶æˆæœ¬æŠ½è±¡**: ç¼–è¯‘æ—¶å¤šæ€ï¼Œæ— è¿è¡Œæ—¶å¼€é”€
3. **RAIIå®‰å…¨**: å¼‚å¸¸å®‰å…¨çš„èµ„æºç®¡ç†
4. **STLå…¼å®¹**: ä¸æ ‡å‡†åº“æ— ç¼é›†æˆ
5. **æ˜“ç”¨æ€§**: ç®€æ´ç›´è§‚çš„API

## âš¡ æ€§èƒ½ç‰¹ç‚¹

- **äº’æ–¥é”ç‰ˆæœ¬**: æœ€å¿«ï¼Œé€‚åˆé€šç”¨åœºæ™¯
- **è¯»å†™é”ç‰ˆæœ¬**: è¯»æ“ä½œå¿«ï¼Œå†™æ“ä½œç•¥æ…¢
- **ç¼–è¯‘æ—¶ä¼˜åŒ–**: é›¶å¼€é”€çš„ç­–ç•¥é€‰æ‹©
- **ç§»åŠ¨è¯­ä¹‰æ”¯æŒ**: å‡å°‘ä¸å¿…è¦çš„å¤åˆ¶

## ğŸ“Š æ€§èƒ½åŸºå‡†æµ‹è¯•

æˆ‘ä»¬æä¾›äº†å…¨é¢çš„æ€§èƒ½åŸºå‡†æµ‹è¯•ç¨‹åºï¼Œå¯¹æ¯” TS_STL ä¸æ ‡å‡† STL å®¹å™¨çš„æ€§èƒ½ã€‚

### è¿è¡Œæ€§èƒ½æµ‹è¯•

```bash
cd build
./performance_benchmark
```

### æ€§èƒ½åŸºå‡†æµ‹è¯•ç»“æœ

| æµ‹è¯•åœºæ™¯ | TS_STL | STD | å¼€é”€ |
|---------|--------|-----|------|
| **å•çº¿ç¨‹é¡ºåºæ’å…¥** (1M æ“ä½œ) | 0.0220s | 0.0112s | +96.1% |
| **å•çº¿ç¨‹éšæœºè®¿é—®** (1M æ“ä½œ) | 0.0626s | 0.0445s | +40.7% |
| **å¹¶å‘å†™å…¥** (10çº¿ç¨‹ x 100K) | 0.0804s | 0.0640s* | +25.5% |
| **List é¡ºåºæ’å…¥** (100K æ“ä½œ) | 0.0061s | 0.0046s | +33.3% |
| **å¹¶å‘è¯»å– RWé”** (10çº¿ç¨‹ x 1M) | 1.6964s | 0.5929s** | -186.1% |
| **æ··åˆè¯»å†™** (5çº¿ç¨‹ x 100K) | 0.0424s | 0.0228s* | +86.2% |

> **æ³¨:**
> - å•çº¿ç¨‹æµ‹è¯•ä¸­ï¼ŒTS_STL æœ‰é¢å¤–çš„é”å¼€é”€ï¼ˆå³ä½¿æœªè¢«ä½¿ç”¨ï¼‰
> - (*) STD åˆ—ä½¿ç”¨ `std::mutex` æ‰‹åŠ¨åŠ é”
> - (**) STD åˆ—ä½¿ç”¨ `std::shared_mutex` å’Œå…±äº«é”
> - RWé”æµ‹è¯•æ˜¾ç¤º TS_STL åœ¨è¯»å¯†é›†å‹åœºæ™¯çš„ä¼˜åŠ¿ï¼ˆ186% å€æ•°å·®å¼‚æ¥è‡ªäºé”äº‰ç«ï¼‰

### æ€§èƒ½åˆ†æ

#### å•çº¿ç¨‹æ€§èƒ½
- **Vector é¡ºåºæ’å…¥**: +96% å¼€é”€ï¼ˆé”åˆå§‹åŒ–å’Œæ£€æŸ¥æˆæœ¬ï¼‰
- **Vector éšæœºè®¿é—®**: +41% å¼€é”€ï¼ˆè™½ç„¶æœ‰é”å¼€é”€ï¼Œä½†ç¼“å­˜å‹å¥½æ€§ç›¸è¿‘ï¼‰
- **List æ“ä½œ**: +33% å¼€é”€ï¼ˆé“¾è¡¨ç»“æ„ç›¸å¯¹å¼€é”€è¾ƒå°ï¼‰

#### å¤šçº¿ç¨‹æ€§èƒ½
- **å¹¶å‘å†™å…¥**: ä»… +25% å¼€é”€ï¼ˆæ‰‹åŠ¨é”å®šæˆæœ¬ç›¸è¿‘ï¼‰
- **å¹¶å‘è¯»å–ï¼ˆRWé”ï¼‰**: TS_STL å¿«å¾—å¤šï¼ˆå¾—ç›Šäºç»†ç²’åº¦é”ç­–ç•¥ï¼‰
- **æ··åˆæ“ä½œ**: +86% å¼€é”€ï¼ˆå–å†³äºè¯»å†™æ¯”ä¾‹ï¼‰

### å…³é”®å‘ç°

1. **å•çº¿ç¨‹åœºæ™¯**ï¼šå•çº¿ç¨‹ä½¿ç”¨æ—¶ï¼Œæœ‰ä¸€å®šçš„é”åˆå§‹åŒ–å¼€é”€ï¼ˆ5-40%ï¼‰
   - è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ `unsafe_*` æ¥å£è·å¾—é›¶å¼€é”€
   - æˆ–ä½¿ç”¨ `with_write_lock()` æ‰¹é‡æ“ä½œ

2. **å¤šçº¿ç¨‹åœºæ™¯**ï¼šåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼ŒTS_STL å¾€å¾€è¡¨ç°æ›´å¥½
   - è‡ªåŠ¨é”ç®¡ç†å‡å°‘äº†æ‰‹åŠ¨é”™è¯¯
   - è¯»å†™é”æä¾›æ˜¾è‘—ä¼˜åŒ–ï¼ˆå¹¶å‘è¯»å–æ€§èƒ½æå‡ï¼‰

3. **è¯»å¯†é›†å‹å·¥ä½œè´Ÿè½½**ï¼šè¯»å†™é” (`vectorRW<T>`) æ˜¾è‘—ä¼˜äºäº’æ–¥é”
   - å¹¶å‘è¯»æ“ä½œå¯ä»¥å®Œå…¨å¹¶è¡Œ
   - æå¤§å‡å°‘äº†é”äº‰ç«

### ä¼˜åŒ–å»ºè®®

**å½“éœ€è¦æè‡´æ€§èƒ½æ—¶ï¼š**

```cpp
// âœ… æ–¹å¼1: ä½¿ç”¨ unsafe æ¥å£ï¼ˆéœ€ç¡®ä¿å¤–éƒ¨åŒæ­¥ï¼‰
vectorMutex<int> vec;
{
    auto guard = vec.acquire_write_guard();
    for (int i = 0; i < N; ++i) {
        vec.unsafe_ref().push_back(i);  // ç›´æ¥è®¿é—®ï¼Œæ— é¢å¤–å¼€é”€
    }
}

// âœ… æ–¹å¼2: æ‰¹é‡æ“ä½œ
vector<int> vec;
vec.with_write_lock([](auto& v) {
    for (int i = 0; i < N; ++i) {
        v.unsafe_ref().push_back(i);  // ä¸€æ¬¡æ€§åŠ é”
    }
});

// âœ… æ–¹å¼3: å•çº¿ç¨‹åˆå§‹åŒ– â†’ å¤šçº¿ç¨‹è¯»å–
vector<int> vec;
// å•çº¿ç¨‹åˆå§‹åŒ–å®Œæˆ
for (int i = 0; i < N; ++i) {
    vec.push_back(i);  // å•çº¿ç¨‹æ—¶æœ‰å¼€é”€
}
// ç°åœ¨å¤šçº¿ç¨‹åªè¿›è¡Œè¯»å–æ“ä½œ
```

## ğŸ” çº¿ç¨‹å®‰å…¨ä¿è¯

- **åŸºæœ¬å¼‚å¸¸ä¿è¯**: å¼‚å¸¸åå®¹å™¨å¤„äºæœ‰æ•ˆçŠ¶æ€
- **å¼ºå¼‚å¸¸ä¿è¯**: å¤šæ•°æ“ä½œè¦ä¹ˆå®Œå…¨æˆåŠŸè¦ä¹ˆå®Œå…¨å¤±è´¥
- **æ— å¼‚å¸¸æ“ä½œ**: ç§»åŠ¨æ“ä½œæ ‡è®°ä¸ºnoexcept

## ğŸ“‹ æ³¨æ„äº‹é¡¹

1. **æŒ‡é’ˆæœ‰æ•ˆæ€§**: `data()` è¿”å›çš„æŒ‡é’ˆå¯èƒ½å› å…¶ä»–çº¿ç¨‹çš„æ“ä½œè€Œå¤±æ•ˆ
2. **è¿­ä»£å™¨**: åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œä¼ ç»Ÿè¿­ä»£å™¨ä¸é€‚ç”¨ï¼Œæ”¹ç”¨ `for_each()` æˆ– `to_vector()`
3. **æ­»é”é£é™©**: åœ¨å›è°ƒå‡½æ•°ä¸­å†æ¬¡è°ƒç”¨å®¹å™¨æ–¹æ³•å¯èƒ½å¯¼è‡´æ­»é”
4. **åŸå­æ€§**: å•ä¸ªæ“ä½œæ˜¯åŸå­çš„ï¼Œä½†å¤šæ“ä½œåºåˆ—å¯èƒ½éœ€è¦é¢å¤–åŒæ­¥

## ğŸš€ æ‰©å±•æ€§

è¿™ä¸ªåº“å¯ä»¥è½»æ¾æ‰©å±•åˆ°å…¶ä»–STLå®¹å™¨ï¼š
- ThreadSafeDeque
- ThreadSafeList
- ThreadSafeMap
- ThreadSafeSet
- ThreadSafeQueue
- ThreadSafeStack

æ ¸å¿ƒçš„é”ç®¡ç†å’Œç­–ç•¥æœºåˆ¶å¯ä»¥ç›´æ¥å¤ç”¨ã€‚

## ğŸ“„ è®¸å¯è¯

MIT License - è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹

---

**å¿«é€Ÿé“¾æ¥ï¼š**
- [è¯¦ç»†ä½¿ç”¨æŒ‡å—](USAGE_GUIDE.md)
- [å®Œæ•´APIæ–‡æ¡£](include/ts_stl.hpp) (ä»£ç ä¸­æœ‰è¯¦ç»†æ³¨é‡Š)
- [æµ‹è¯•ä»£ç ](test/test_thread_safe_vector.cpp)
- [ä½¿ç”¨ç¤ºä¾‹](examples/example_usage.cpp)

## ğŸ†• é«˜çº§åŠŸèƒ½ï¼ˆæ–°å¢ï¼‰

### å¯¹è±¡åˆå§‹åŒ–è¯¦è§£

#### åŸºç¡€åˆå§‹åŒ–æ–¹å¼å¯¹æ¯”

```cpp
// â¶ é»˜è®¤æ„é€ ï¼ˆæ¨èç®€æ´ç”¨æ³•ï¼‰
vector<int> vec1;                    // è‡ªåŠ¨ä½¿ç”¨äº’æ–¥é”

// â· ä½¿ç”¨ç±»å‹åˆ«åï¼ˆæœ€å¸¸ç”¨ï¼‰
vectorMutex<int> vec2;               // äº’æ–¥é”ç‰ˆæœ¬
vectorRW<int> vec3;                  // è¯»å†™é”ç‰ˆæœ¬ï¼ˆC++17+ï¼‰

// â¸ æ˜¾å¼æ¨¡æ¿å‚æ•°ï¼ˆæ˜ç¡®æŒ‡å®šï¼‰
vector<int, LockPolicy::Mutex> vec4;
#if TS_STL_SUPPORT_RW_LOCK
vector<int, LockPolicy::ReadWrite> vec5;  // C++17+ å¯ç”¨
#endif

// â¹ å¸¦åˆå§‹å€¼çš„æ„é€ 
vectorMutex<int> vec6(10);           // 10ä¸ªé»˜è®¤å…ƒç´ 
vectorMutex<int> vec7(10, 42);       // 10ä¸ªå€¼ä¸º42çš„å…ƒç´ 

// âº ä»å…¶ä»–å®¹å™¨åˆå§‹åŒ–
std::vector<int> source = {1, 2, 3, 4, 5};
vectorMutex<int> vec8(source.begin(), source.end());

// â» å¤æ‚æ•°æ®ç±»å‹åˆå§‹åŒ–
struct User { std::string name; int age; };
vectorRW<User> users;                // ç”¨äºå¤šè¯»å°‘å†™çš„åœºæ™¯
users.push_back({"Alice", 25});
users.push_back({"Bob", 30});
```

#### ä¸åŒåœºæ™¯çš„åˆå§‹åŒ–é€‰æ‹©

```cpp
// åœºæ™¯1: é€šç”¨ç¼“å†²åŒº â†’ äº’æ–¥é”
vectorMutex<std::string> log_buffer;
log_buffer.push_back("event 1");

// åœºæ™¯2: é…ç½®æ•°æ®ï¼ˆè¯»å¤šå†™å°‘ï¼‰ â†’ è¯»å†™é”
vectorRW<Config> config;
config.push_back(Config{...});

// åœºæ™¯3: æ€§èƒ½å…³é”®ä»£ç  â†’ äº’æ–¥é” + é«˜çº§æ¥å£
vectorMutex<double> data(1000);  // é¢„ç•™1000å…ƒç´ 
data.reserve(2000);

// åœºæ™¯4: å…¼å®¹æ—§ä»£ç  â†’ é»˜è®¤æ„é€ 
vector<int> legacy;  // è‡ªåŠ¨é€‰æ‹©äº’æ–¥é”
```

### çº¿ç¨‹ä¸å®‰å…¨æ¥å£
æä¾›é›¶å¼€é”€çš„ `unsafe_*` æ¥å£ï¼Œç”¨äºåœ¨å·²è·å–é”æˆ–å•çº¿ç¨‹ç¯å¢ƒä¸‹è¿›è¡Œæè‡´ä¼˜åŒ–ã€‚

### æ‰‹åŠ¨é”æ§åˆ¶
- `acquire_write_guard()` - è·å–å†™é”
- `with_write_lock()` - åœ¨å†™é”ä¿æŠ¤ä¸‹æ‰§è¡Œä»£ç å—
- `acquire_read_guard()` (C++17+) - è·å–è¯»é”
- `with_read_lock()` (C++17+) - åœ¨è¯»é”ä¿æŠ¤ä¸‹æ‰§è¡Œä»£ç å—

### C++ ç‰ˆæœ¬æ¡ä»¶ç¼–è¯‘
- C++17+: å®Œæ•´åŠŸèƒ½ï¼ˆäº’æ–¥é” + è¯»å†™é” + è‡ªæ—‹é”ï¼‰
- C++<17: åŸºç¡€åŠŸèƒ½ï¼ˆä»…äº’æ–¥é” + è‡ªæ—‹é”ï¼‰


---

**å¿«é€Ÿé“¾æ¥ï¼š**
- [è¯¦ç»†ä½¿ç”¨æŒ‡å—](docs/USAGE_GUIDE.md)
- [å®Œæ•´APIæ–‡æ¡£](include/ts_stl.hpp) (ä»£ç ä¸­æœ‰è¯¦ç»†æ³¨é‡Š)
- [æµ‹è¯•ä»£ç ](test/test_thread_safe_vector.cpp)
- [é«˜çº§åŠŸèƒ½æµ‹è¯•](test/test_advanced_features.cpp)
- [ä½¿ç”¨ç¤ºä¾‹](examples/example_usage.cpp)
